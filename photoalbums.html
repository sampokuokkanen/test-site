<!DOCTYPE html>
<html lang = "en">
<head>
<meta charset ="UTF-8">
  <title>My First Page Ever</title>
		<link href="css/bootstrap.css" rel="stylesheet">
	    <link href="css/styles.css" rel="stylesheet">
  		<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
  	    <script src="js/handlebars-v4.0.11.js"></script>
  	    <script src="js/bootstrap.min.js"></script>
</head>

	<body>
	 <nav class="navbar navbar-default">
      <div class="container-fluid">
      <div class="navbar-header">
       <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main_navbar" aria-expanded="false">
       Open!</button>
       <a class="navbar-brand" href="index.html">Sampo Kuokkanen</a>
       </div>
       <div class="collapse navbar-collapse" id="main_navbar">
       <ul class="nav navbar-nav">
         <li><a href="index.html">
	     Home</a></li>
	     <li>
		 <a href="about.html">
	     About</a></li>
	     <li>
		 <a href="contact.html">
	     Contact</a></li>
         <li class="active">
             <a href="photoalbums.html">Photo albums</a>
         </li>
       </ul>
      </div>   
      </nav> 

    <div class="container">

    <!-- the page title -->
    <div class="page-header">
      <h1>My photo albums </h1>
        		<ol class="breadcrumb">
		<li><a href="index.html">Home</a></li>
		<li><a href="photoalbums.html">Photo albums</a>
                    </li>
        </ol>
    </div>


    <!--
      the search box.
      It is given the navbar-form class so that bootstrap
      put it in the top navbar
    -->
    <div class="navbar-form navbar-right">
      <input id="searchbox" type="text" class="form-control" placeholder="Search...">
    </div>

    <!--
      We don't actually use these navigation tabs in this example, but
      I've included them so that the top nav looks right, and
      we can extend the example later to use them
    -->
    <ul class="nav nav-tabs">
          <li role=""  id="detailsbtn"><a href="#">Details</a></li>
          <li role="" id="modalbtn"><a href="#">Modal</a></li>
    </ul>
    <br/><br/>

    <!--
     the content of the web page starts off empty
     because we will fill it later from the template
     We use container-fluid because our template uses
     the bootstrap grid
    -->
    <div id="content"  class="container-fluid"  role="main">
    </div>

    <!--
      this div will contain the modal dialog which will
      display the large image
    -->
    <div id="modal-container">
    </div>
  </div>

  <!--
    This template displays many photos in an album.
    Is uses the {{#each }} template tag which repeats the
    innter bit of the template for each element of an array
  -->
  <script id="album-template" type="text/x-handlebars-template">

      <div class="row display-flex">
        {{#each images}}
        <div class="col-xs-6 col-lg-4">
         <div class="thumbnail" data-id="{{@index}}">
            <img class="crop-img" src="{{src}}" alt=""/>

             <div class="author">
                <h5> {{title}} </h5>
                <p> {{author}} </p>
             </div>
          </div>

          </div> <!-- / col -->
          {{/each}}
      </div> <!-- / row -->
    </script>

    <!--
         This second template displays a modal pop-up of the image.
         It has quite a bit of boilder plate HTML code but in
         essence it just displays and image tag within a
         set of divs that define the modal
    -->
    <script id="modal-template" type="text/x-handlebars-template">
      <div id="imageModal" class="modal fade" role="dialog">
        <div class="modal-dialog"  style="width:800">

          <div class="modal-content">

            <div class="modal-body">
              <img  style="width:100%" src="{{src}}"/>
            </div>

          </div>

        </div>
      </div>
    </script>

  <!--
    The javascript code to instantiate the template
  -->
  <script type="text/javascript">
    // get the source code for our two template
    // and compile them
    var source   = $("#album-template").html();
    var template = Handlebars.compile(source);

    source   = $("#modal-template").html();
    var modal_template = Handlebars.compile(source);

    // define the data for the template
    // we define an objects which contains an
    // array of other objects. This array will be used
    // to create multiple images
    var data = {images:[
        {
       src:"test2.jpg",
           title:"wwii woman worker",
           author:"Another author",
        },
        {
       src: "test00.jpg",
           title: "Shopping Center",
           author: "Tuxyso",
           },
        {
       src: "test0.jpg", 
           title:"The Earth seen from",
           author:"Ed g2s"
           },
        {
       src:"test1.jpg",
           title: "horse nebula",
           author: "John Smith",
           },
        {
       src:"test3.jpg",
           title:"Lijiang Yunnan",
           author:"Wikimedia Commons",
           },
        {
       src:"test4.jpg",
           title:"Marco's house",
           author:"Wikimedia Commons",
           },
        {
       src:"test5.jpg",
           title:"Marco's house",
           author:"Wikimedia Commons",
           },
        {
       src:"test6.jpg",
           title:"Marco's house",
           author:"Wikimedia Commons",
           },
        {
       src:"test7.jpg",
           title:"Saku 12",
           author:"Wikimedia Commons",
           },
        {
       src:"test8.jpg",
           title:"Marco's house",
           author:"Wikimedia Commons",
           },
        {
       src:"test9.jpg",
           title:"Marco's house",
           author:"Wikimedia Commons",
           },
                {
       src:"test2.jpg",
           title:"wwii woman worker",
           author:"Another author",
        },
        {
       src: "test00.jpg",
           title: "Shopping Center",
           author: "Tuxyso",
           },
        {
       src: "test0.jpg", 
           title:"The Earth seen from Apollo 17",
           author:"Ed g2s"
           },
        {
       src:"test1.jpg",
           title: "horse nebula",
           author: "John Smith",
           },
        {
       src:"test3.jpg",
           title:"Lijiang Yunnan China Naxi people carrying baskets-",
           author:"Wikimedia Commons",
           },
        {
       src:"test4.jpg",
           title:"Marco's house",
           author:"Wikimedia Commons",
           },
        {
       src:"test5.jpg",
           title:"Marco's house",
           author:"Wikimedia Commons",
           },
        {
       src:"test6.jpg",
           title:"Marco's house",
           author:"Wikimedia Commons",
           },
        {
       src:"test7.jpg",
           title:"Saku 12",
           author:"Wikimedia Commons",
           },
        {
       src:"test8.jpg",
           title:"Marco's house",
           author:"Wikimedia Commons",
           },
        {
       src:"test9.jpg",
           title:"Marco's house",
           author:"Wikimedia Commons",
           },
         ]};

    // render the data into the template
    var html    = template(data);
    // put the rendered template into the DOM
    $('#content').html(html);

    // a function to display a clicked
    // image as a modal
    // this is added as a click callback
    // to the thumbnails
    function displayModal(event){
        // get the index (position in the array)
        // of the photo we clicked on
        // "this" is the element that was clicked on
        // data("id") gets the attribute data-id
        // (which we set to the index of the photo in
        // the array - @index)
        var imageNumber = $(this).data("id");

        // get the image out of the array using the image
        // number and render it using the modal template
        var html    = modal_template(data.images[imageNumber]);
        // put the modal template in the DOM
        $('#modal-container').html(html);

        // show the modal
        $("#imageModal").modal('show');
    }

    // display the modal when you click on a thumbnail
    $('.thumbnail').click(displayModal);

    // the search functionality
    // this happens when a key is pressed
    // inside the search box
    $('#searchbox').keypress(function (e) {

      // check if the key that was pressed
      // is the return key (it has id 13)
      // and only do the search if it is
      if (e.which == 13) {

        // get the search text which is the
        // contents of the search box
        var search_text = $('#searchbox').val();

        // print the search box
        // (this is an example of using
        // console.log for debugging)
        console.log(search_text)

        // create a new array of data with only
        // the data that contains the search string
        var filteredData = {

          // use the filter function which returns
          // a new array that contains only the
          // elements of data.images for which
          // the function returns true
          images: data.images.filter(function(d){

            // return true if the title contains
            // the search text
            if (d.title.search(search_text) > -1){
              return true;
            }

            // return true if the author contains
            // the search text
            if (d.author.search(search_text) > -1){
              return true;
            }

            // if we reach here it means we haven't
            // found a match so return false
            return false;
          })
        };

        // pass the newly filtered data into
        // the template to generate new html
        var html    = template(filteredData);
        $('#content').html(html);

        // display the modal when you click on a thumbnail
        $('.thumbnail').click(displayModal);
      }
    });

  </script>

</body>